---
title: "파일 시스템"
categories: OS
---

## File
- HDD나 SSD 같은 보조기억장치에 저장된 정보의 집합
- 모든 파일에는 이름, 파일을 실행하기 위한 정보, **파일 관련 부가 정보**가 있음
- **파일 관련 부가 정보**는 attribute(속성) 또는 metadata 라고 부름

### 파일 속성과 유형

|속성 이름|의미|
|---|---|
|유형|OS가 인지하는 파일의 종류 ex) exe(Window) dmg(Mac)|
|크기|파일의 현재 크기와 허용 가능한 최대 크기|
|보호|어떤 사용자가 파일을 읽고 쓰고 실행할 수 있는지 나타냄|
|생성 날짜|파일에 생성된 날짜|
|마지막 접근 날짜|파일에 마지막으로 접근한 날짜|
|마지막 수정 날짜|파일에 마지막으로 수정한 날짜|
|생성자|파일을 생성한 사용자|
|소유자|파일을 소유한 사용자|
|위치|파일의 보조기억장치상의 현재 위치|

### File 시스템 호출
- 파일을 다루는 모든 작업은 운영체제의해 이뤄짐
- 어떤 응용 프로그램도 임의로 파일을 조작할 수 없으며 파일을 다루려면 운영체제에 부탁해야 됨
- 파일 생성, 삭제, 열기, 닫기, 읽기, 쓰기

## Directory
### Directory 시스템 호출
- 디렉터리 생성, 삭제, 열기, 닫기, 읽기

### Directory Entry
- 운영체제는 디렉터리도 파일로 취급함, 단지 포함된 정보가 조금 특별할 뿐
- 파일 내부는 파일과 관련된 정보를 담고 있다면, 디렉터리는 자신이 담고 있는 대상과 관련된 정보를 담고 있음
- 그리고 관련된 정보들은 Table(표)형태로 구성되며, 디렉터리는 보조기억장치에 테이블 형태로 정보가 저장됨

### Single-level Directory(1단계 디렉터리)
![]({{site.url}}/images/SingleDirectory.png)
- 옛날 운영체제는 하나의 디렉터리만 존재
- 모든 파일이 하나의 디렉터리 아래에 있었음

### Tree-structured Directory(트리 구조 디렉터리)
![]({{site.url}}/images/TreeDirectory.png)
- 1단계 디렉터리로는 많은 파일을 관리하기 어렵기 때문에 생겨남
- 최상위 디렉터리가 있고 아래에 여러 서브 디렉터리가 있음
- 최상위 디렉터리는 root directory라고 부르고 /로 표현 

## Path(경로)
- 대부분의 운영체제는 현재 작업 디렉터리를 .(마침표)로 나타내고 바로 위의 상위 디렉터리를 ..로 표현
### Absolute Path(절대 경로)
- 루트 디렉터리에서 자기 자신까지 이르는 고유한 경로
- 루트 디렉터리 이미지에서 a.jpg의 경로는 /home/host/a.jpg로 표현
### Relative Path(상대 경로)
- 루드 디렉터리에서 시작하는게 아닌 현재 디렉터리부터 시작하는 경로
- 루트 디렉터리 이미지에서 현재 guest에 위치에 있는 상태에서의 a.jpg 경로는 ./host/.a.jpg로 표현

## File System(파일 시스템)

- 파일과 디렉터리를 보조기억장치에 간결하게 저장하고 접근할 수 있게 하는 운영체제 내부 프로그램
- 이제 막 생산되어 한 번도 사용한적 없는 HDD, SSD의 경우 사용하려면 나누는 작업(파티셔닝)과 포맷 작업(포맷팅)을 거쳐야 파일과 폴더를 생성할 수 있음

### Partitioning(파티셔닝)
- 저장 장치의 논리적인 영역을 나누는 작업
- 나누기 전보다 정리가 수월해짐
- Partition: 파티셔닝으로 나누어진 영역, Partition 마다 다른 파일 시스템을 적용할 수 있음
- ex) 방 하나에 가벽 하나를 세워 두개의 구역으로 나눔

### Formatting(포맷팅)
- 파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지 설정하고 새로운 데이터를 쓸 준비를 함
- 어떤 종류의 파일 시스템을 사용할지 이때 결정함
- 저수준 포매팅: 저장 장치를 생성할 당시로 바꾸는 물리적인 포매팅
- 고수준 포매팅: 파일 시스템을 생성하는 포매팅

### FAT File System
- 연결 할당 기반 파일 시스템, 연결 할당의 단점을 보완한 파일 시스템
- FAT(File Allocation Table, 파일 할당 테이블)을 통해 각 블록의 다음 블록 주소들을 모아서 관리
- 초기에 마이크로소프트의 운영체제에서 사용되었고 최근에는 USB메모리, SD카드와 같은 저용량 저장장치에 많이 사용
- 버전에 따라 FAT12, FAT16, FAT32가 있으며 숫자는 블록을 표현하는 비트 수를 의미

![]({{site.url}}/images/FAT.png)
- FAT 파일 시스템 디렉터리 엔트리 형식
- File Attribute: 해당 파일이 읽기 전용파일인지, 숨김 파일전용인지, 시스템파일인지 등등을 식별하기 위한 항목

### Unix File System
- 색인 할당 기반 파일 시스템
- 색인 블록 = i-node, 파일의 속성 정보와 15개의 블록 주소 저장 가능(i-node만으로 파일속성과 관련된 것들이 15개의 블록에 저장되어 있음)
- 15개 블록 이상인 파일을 저장하는 방법
    1. 블록 주소 중 12개는 직접 블록 주소 저장
    2. 1번이 충분하지 않다면 13번째 주소에 단일 간접 블록 주소 저장
    3. 2번으로 충분하지 않다면 14번째 주소에 이중 간접 블록 주소 저장
    4. 3번으로 충분하지 않다면 15번째 주소에 삼중 간접 블록 주소 저장

![]({{site.url}}/images/UnixFileSystem.png)
- 유닉스 파일 시스템의 디렉터리 엔트리
- i-node가 파일의 모든 것을 담고 있음

## 파일 할당 방법
- HDD의 가장 작은 저장 단위는 **Sector**, OS는 파일과 디렉터리를 **Block** 단위로 읽고 씀
- 파일 시스템이 Sector를 사용하기에는 개수가 너무 많고 크기가 작음(그래서 Block 단위로 사용)

### Contiguous Allocation(연속 할당)
- 가장 단순한 방식, 보조기억장치 내 연속적으로 블록에 파일을 할당
- 할당된 파일을 찾을 때는 파일의 첫번째 블록 주소와, 블록 단위의 길이만 알면 됨
- **외부 단편화**를 야기한다는 단점이 있음 (**때문에 현재에는 불연속 할당을 주로 사용**) 

### Linked Allocation(연결 할당, 불연속 할당)
- 블록에 다음 블록의 주소를 저장해서 각 블록이 다음 블록을 가리키는 형태(데이터를 **연결 리스트**로 보관)
- 파일이 여러 블록에 흩어져 저장되어도 문제가 없음
- 디렉터리 엔트리에는 파일이름, 첫번째 블록 주소, 블록의 길이가 저장됨
- 외부 단편화를 해결하지만 찾을 때는 첫 번째 블록부터 하나씩 차례대로 찾아야 함(Random Access, 임의 접근)
- 하나의 블록에 다음 블록 주소가 포함되어 있다 보니 하드웨어 고장이나 오류로 인해 블록에 하나라도 문제가 생기면 그 이후의 블록에는 접근할 수 없음

### Indexed Allocation(색인 할당, 불연속 할당)
- 파일의 모든 블록 주소를 Index Block(색인 블록)이라는 하나의 블록에 모아서 관리하는 방식
- 파일에 접근하려면 색인 블록의 i번째 항목이 가리키는 블록에 접근하면 되기 때문에 접근이 용이함
- 색인 할당을 사용하는 파일 시스템에서는 디렉터리 엔트리에 파일 이름, 색인 블록 주소를 명시함

## Reference
[혼자 공부하는 컴퓨터구조]()
